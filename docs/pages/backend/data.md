# Структура базы данных

В данном документе описана структура базы данных проекта. База данных состоит из нескольких таблиц, каждая из которых отвечает за хранение определённых данных, используемых в системе.

---

## Таблица `auth_provider_relations`

**Назначение**: Хранение информации о связях пользователей с провайдерами аутентификации.

**Поля**:  
- `provider_slug` (`Utf8`): Уникальный идентификатор провайдера аутентификации.  
- `provider_service` (`Utf8`): Название сервиса провайдера.  
- `provider_user_id` (`Utf8`): Идентификатор пользователя у провайдера.  
- `user_id` (`Utf8`): Уникальный идентификатор пользователя в системе.  
- `linked_at` (`Datetime`): Дата и время связывания учетной записи.  
- `used_at` (`Datetime`): Дата и время последнего использования связи.  

**Первичный ключ**: `provider_slug`, `provider_user_id`.

---

## Таблица `events`

**Назначение**: Хранение информации о событиях (мероприятиях).

**Поля**:  
- `id` (`Utf8`): Уникальный идентификатор события.  
- `organization_id` (`Utf8`, `NOT NULL`): Идентификатор организации, проводящей событие.  
- `title` (`Utf8`, `NOT NULL`): Название события.  
- `description` (`Utf8`): Описание события.  
- `type` (`Utf8`, `NOT NULL`): Тип события.  
- `discipline` (`Utf8`, `NOT NULL`): Дисциплина события.  
- `start_date` (`Timestamp`, `NOT NULL`): Дата и время начала события.  
- `end_date` (`Timestamp`): Дата и время окончания события.  
- `status` (`Utf8`, `NOT NULL`): Статус события.  
- `age_group` (`Utf8`): Возрастная группа участников.  
- `protocol_s3_key` (`Utf8`): Ключ протокола события в хранилище S3.  

**Первичный ключ**: `id`.

---

## Таблица `notifications`

**Назначение**: Хранение уведомлений для пользователей.

**Поля**:  
- `id` (`Utf8`): Уникальный идентификатор уведомления.  
- `type` (`Utf8`): Тип уведомления.  
- `text` (`Utf8`): Текст уведомления.  
- `sender_id` (`Utf8`): Идентификатор отправителя.  
- `receiver_id` (`Utf8`): Идентификатор получателя.  
- `sent_at` (`Datetime`): Дата и время отправки.  
- `read_at` (`Datetime`): Дата и время прочтения.  

**Первичный ключ**: `id`.

---

## Таблица `organizations`

**Назначение**: Хранение информации об организациях (ФСП).

**Поля**:  
- `id` (`Utf8`, `NOT NULL`): Уникальный идентификатор организации.  
- `district` (`Utf8`, `NOT NULL`): Округ организации.  
- `region` (`Utf8`, `NOT NULL`): Регион организации.  
- `manager` (`Utf8`): Менеджер организации.  
- `email` (`Utf8`): Электронная почта.  
- `description` (`Utf8`): Описание организации.  

**Первичный ключ**: `id`.

---

## Таблица `regions`

**Назначение**: Хранение статистических данных по регионам.

**Поля**:  
- `id` (`Utf8`): Уникальный идентификатор региона.  
- `name` (`Utf8`): Название региона.  
- `algorithm_count` (`Int16`): Количество мероприятий по алгоритмам.  
- `hackathon_count` (`Int16`): Количество хакатонов.  
- `cyber_security_count` (`Int16`): Количество мероприятий по кибербезопасности.  
- `russian_events_count` (`Int16`): Количество российских мероприятий.  
- `foreign_events_count` (`Int16`): Количество зарубежных мероприятий.  
- `algorithm_winners_count` (`Int16`): Количество победителей в алгоритмических соревнованиях.  
- `hackathon_winners_count` (`Int16`): Количество победителей в хакатонах.  
- `cyber_security_winners_count` (`Int16`): Количество победителей в соревнованиях по кибербезопасности.  

**Первичный ключ**: `id`.

---

## Таблица `requests`

**Назначение**: Хранение запросов пользователей.

**Поля**:  
- `id` (`Utf8`): Уникальный идентификатор запроса.  
- `created_at` (`Datetime`): Дата и время создания запроса.  
- `type` (`Utf8`): Тип запроса.  
- `status` (`Utf8`): Статус запроса.  
- `requester_id` (`Utf8`): Идентификатор инициатора запроса.  
- `requester_type` (`Utf8`): Тип инициатора.  
- `requested_id` (`Utf8`): Идентификатор запрашиваемого объекта.  
- `requested_type` (`Utf8`): Тип запрашиваемого объекта.  
- `comment` (`Utf8`): Комментарий к запросу.  
- `updated_at` (`Datetime`): Дата и время последнего обновления.  
- `other_data` (`Json`): Дополнительные данные.  
- `subject` (`Utf8`): Тема запроса.  

**Первичный ключ**: `id`.

---

## Таблица `team_events`

**Назначение**: Связь команд с мероприятиями, в которых они участвовали.

**Поля**:  
- `id` (`Utf8`): Уникальный идентификатор записи.  
- `event_id` (`Utf8`): Идентификатор события.  
- `team_id` (`Utf8`): Идентификатор команды.  
- `placement` (`Uint8`): Занятое место.  
- `event_title` (`Utf8`): Название события.  
- `event_type` (`Utf8`): Тип события.  
- `event_discipline` (`Utf8`): Дисциплина события.  

**Первичный ключ**: `id`.

---

## Таблица `teams`

**Назначение**: Хранение информации о командах.

**Поля**:  
- `id` (`Utf8`): Уникальный идентификатор команды.  
- `name` (`Utf8`): Название команды.  
- `fsp_id` (`Utf8`): Идентификатор организации (ФСП).  
- `description` (`Utf8`): Описание команды.  
- `captain` (`Utf8`): Идентификатор капитана команды.  
- `participants` (`Utf8`): Участники команды.  

**Первичный ключ**: `id`.

---

## Таблица `users`

**Назначение**: Хранение информации о пользователях системы.

**Поля**:  
- `user_id` (`Utf8`): Уникальный идентификатор пользователя.  
- `first_name` (`Utf8`): Имя пользователя.  
- `last_name` (`Utf8`): Фамилия пользователя.  
- `second_name` (`Utf8`): Отчество пользователя.  
- `email` (`Utf8`): Электронная почта.  
- `phone` (`Utf8`): Телефон пользователя.  
- `avatar` (`Utf8`): URL аватара пользователя.  
- `region_id` (`Utf8`): Идентификатор региона.  
- `tg_id` (`Utf8`): Идентификатор Telegram.  
- `snils` (`Utf8`): СНИЛС пользователя.  
- `roles` (`Json`): Роли пользователя в системе.  
- `status` (`Utf8`): Статус пользователя.  
- `required` (`Json`): Требуемые действия от пользователя.  
- `notification_ways` (`Json`): Предпочтительные способы уведомления.  
- `created_at` (`Datetime`): Дата и время регистрации.  
- `last_login_at` (`Datetime`): Дата и время последнего входа.  
- `other_data` (`Json`): Дополнительные данные.  

**Первичный ключ**: `user_id`.

---

## Примечания

1. **Типы данных**: Используются типы данных YDB, такие как `Utf8`, `Json`, `Datetime`, `Timestamp`, `Int16`, `Uint8`.  
2. **Связи между таблицами**: Поля, содержащие идентификаторы (`id`), используются для установления связей между таблицами.  
3. **Первичные ключи**: Обеспечивают уникальность записей и оптимизируют поиск данных.

---

## Заключение

Представленная структура базы данных обеспечивает эффективное хранение и управление данными, необходимыми для функционирования системы. Таблицы спроектированы таким образом, чтобы поддерживать целостность данных и обеспечивать быстрый доступ к информации.
