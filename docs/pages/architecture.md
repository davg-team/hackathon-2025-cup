# Архитектура бэкенда

Бэкенд проекта представляет собой микросервисную систему, которая поддерживает полную бизнес-логику платформы «Федерация Спортивного Программирования». Каждый сервис отвечает за свою предметную область и взаимодействует с остальными по HTTP REST через единый API Gateway, а все данные хранятся в распределённой YDB.

---

## Краткое описание решения

- **Ключевая идея**: разделение на доменные сервисы для изоляции ответственности, упрощения разработки и масштабирования.  
- **Инновационные аспекты**:  
  - авто-партиционирование в YDB для любого объёма данных,  
  - сквозная аналитика по событиям, заявкам и результатам,  
  - единая точка маршрутизации (API Gateway) с проверкой JWT.  
- **Используемые технологии**: Python (FastAPI), Go (Gin), YDB, OAuth2/JWT, Docker/Serverless.

---

## Технологический стек

- **Языки**: Python, Go  
- **Фреймворки**: FastAPI (Python), Gin (Go)  
- **База данных**: YDB (Yandex Database)  
- **Аутентификация**: OAuth2, JWT  
- **Контейнеризация**: Docker, Serverless  

---

## Микросервисная структура

| Сервис                   | Ответственность                                                                 |
|--------------------------|----------------------------------------------------------------------------------|
| **users-service**        | Аутентификация/авторизация, управление профилями и ролями                        |
| **organizations**        | CRUD Федераций и региональных представительств                                   |
| **events**               | CRUD соревнований, фильтрация, публикация/архивация                              |
| **applications-service** | Приём, автопроверка и модерация заявок (индивидуальных и командных)              |
| **teams**                | Создание и управление составами команд, приглашения участников                   |
| **reports**              | Хранение результатов, генерация и выдача итоговых протоколов                     |
| **analytics**            | Сбор метрик, построение дашбордов, экспорт отчётов                               |
| **files-service**        | Загрузка, хранение и раздача файлов (аватары, протоколы, изображения)            |

---

## Взаимодействие между сервисами

- **API Gateway** проверяет JWT, маршрутизирует запросы к нужным сервисам.  
- **applications-service → users-service**: получение данных о пользователях (капитаны, участники).  
- **analytics → {events, reports, applications-service}**: агрегирует данные для дашбордов.  
- Каждый сервис обращается напрямую к YDB для чтения/записи своих таблиц.

---

## Компоненты системы

### 1. API Gateway  

- Входная точка для всех REST-запросов.  
- Валидация JWT, CORS, rate-limiting, маршрутизация.

### 2. users-service  

- Аутентификация (OAuth2), выдача JWT.  
- CRUD профилей, управление ролями и правами.  

### 3. organizations  

- CRUD федераций и региональных представительств.  
- Связь организаций с событиями и пользователями.  

### 4. events  

- Создание, обновление, удаление соревнований.  
- Фильтрация по дате, дисциплине, региону, формату.  

### 5. applications-service  

- Приём командных и индивидуальных заявок.  
- Автоматическая проверка дедлайнов, региональных ограничений.  
- Взаимодействие с users-service для валидации участников.  

### 6. teams  

- Создание команд, приглашения участников, управление составом.  

### 7. reports  

- Запись итоговых результатов

### 8. analytics  

- Сбор статистики: число заявок, участников, средние результаты.  
- Генерация дашбордов и экспорт CSV/XLSX.  

### 9. files-service  

- Загрузка и хранение файлов в S3-совместимом хранилище.  
- Выдача ссылок и управление правами доступа.  

---

## Преимущества архитектуры

- **Модульность**: независимая разработка и деплой сервисов.  
- **Масштабируемость**: каждый сервис можно отдельно масштабировать.  
- **Надёжность**: сбой одного сервиса не влечёт остановку всей системы.  
- **Производительность**: авто-партиционирование YDB, прямые запросы без посредников.  

---

# Заключение

Данная архитектура обеспечивает ясное разделение ответственности, простоту сопровождения и готовность к росту нагрузки. Все сервисы взаимодействуют через единый API Gateway и используют YDB как консистентное распределённое хранилище, что гарантирует высокую доступность и отказоустойчивость.  

![alt text](<diagram.png>)
